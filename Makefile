# ------------------------------------------------------------------------------
# file: Makefile
# type: GNU makefile
# project: awkmake
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# variables
# ------------------------------------------------------------------------------

export build_tacl := ./repo/hello/build
export build_mk := ./build.mk

targets :=
targets += $(build_mk)

scripts_dir := ./scripts
createBuildmk_awk := $(scripts_dir)/createBuildmk.awk

RM := rm -fR

# ------------------------------------------------------------------------------
# rules
# ------------------------------------------------------------------------------

# --------------------------------------
# all
# --------------------------------------
all: $(targets)

# --------------------------------------
# .ONESHELL
# --------------------------------------
.ONESHELL:

# --------------------------------------
# .PHONY
# --------------------------------------
.PHONY: .ONESHELL all clean

# --------------------------------------
# build_mk
# --------------------------------------
$(build_mk): $(build_tacl) $(createBuildmk_awk)
	@echo "Building $@"
	$(createBuildmk_awk) < $(build_tacl) > "$@" #2> /dev/null

# --------------------------------------
# clean
# --------------------------------------
clean:
	@echo "Deleting all targets and intermediate files"
	-@$(RM) $(targets)

# ------------------------------------------------------------------------------
# EOF
# ------------------------------------------------------------------------------
